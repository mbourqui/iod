\documentclass[11pt,a4paper,twoside,onecolumn,titlepage]{report}
\usepackage[utf8]{inputenc}
\usepackage{ucs}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{enumerate}
\usepackage{listingsutf8}
\usepackage[numbered,autolinebreaks]{mcode}
\usepackage{caption}
\usepackage{pgfplotstable}
\usepackage{booktabs}
\DeclareCaptionFont{white}{\color{white}}
\DeclareCaptionFormat{listing}{\colorbox{gray}{\parbox{\textwidth}{#1#2#3}}}
\captionsetup[lstlisting]{format=listing,labelfont=white,textfont=white}

\renewcommand{\thesection}{\arabic{section}}

\lstset{
language=matlab,
extendedchars=\true,
inputencoding=utf8/latin1
}

\title{Résolution d'un problème d'optimisation différentiable}
\author{Marc \textsc{Bourqui} \and Victor \textsc{Constantin} \and Ian \textsc{Schori} \and Floriant \textsc{Simond}}


% Le rapport a rendre pour le 11 janvier 2013 doit contenir:
% - Code Matlab
% - Expliquer les questions spécifiques du problème
% - Expliquer les comparaisons du problème
% - Les résultats




\begin{document}

\maketitle

\section*{Énoncé du problème}

Trouver (une approximation de) la solution du problème suivant en appliquant le théorème de la plus forte pente:
\begin{equation}
\min_{x\in\mathbb{R}^2} (x_1-2)^4 + (x_1-2)^2x_2^2 + (x_2+1)^2
\end{equation}

\section*{Réponses aux questions}

\begin{enumerate}[(a)]
\item\label{pfp} Implémenter la méthode de plus forte pente (Algorithme 11.3) à l'aide du logiciel MATLAB. Déterminer la taille du pas en appliquant la recherche linéaire, Algorithme 11.2 (les deux conditions de Wolfe).

%
% Mettre la réponse ici
%
\lstinputlisting[label=pfp.m, caption=pfp.m]{pfp.m}
Pour \texttt{pfp.m}, nous avons réutilisé la structure du corrigé de la série 3. Nous l'avons adapté pour y résoudre l'algorithme de plus forte pente, selon l'algorithme 11.3. La fonction, son gradient et sa hessienne sont placés dans un fichier que nous avons nommé \texttt{f.m}. De plus, nous avons ajouté un booléan \mcode{useRL} qui permet de sélectionner la méthode de détermination du pas (recherche linéaire ou le pas calculé en (\ref{pas})).


\lstinputlisting[label=pfpInnerLoop.m, caption=pfpInnerLoop.m]{pfpInnerLoop.m}
Effectue une itération de l'algorithme en utilisant la méthode de calcul du pas spécifiée. Le choix est effectué à l'aide du booléen \mcode{useRL} qui permet de choisir entre la recherche linéaire et la méthode indiquée au point (\ref{pas}).


\lstinputlisting[label=rechercheLineaire.m, caption=rechercheLineaire.m]{rechercheLineaire.m}
Implémente la recherche linéaire d'après l'algorithme 11.2. \mcode{fx} est la fonction évaluée en \mcode{x}, et \mcode{gfx} est son gradient en \mcode{x}. Nous avons choisi de les passer en paramètres pour ne pas devoir les recalculer. Mais pour plus de modularité, on peut déterminer \mcode{fx} et \mcode{gfx} en ajoutant \mcode{[fx, gfx] = feval(f, x);} avant la boucle \mcode{while}.


\item\label{pas} Implémenter une fonction qui donne la taille du pas suivant:
\begin{equation}
\alpha_k = \frac{\bigtriangledown f(x_k)^T \bigtriangledown f(x_k)}{\bigtriangledown f(x_k)^T \bigtriangledown^2 f(x_k) \bigtriangledown f(x_k)}
\end{equation}

Quelle est la nature de ce pas? D'où cette formule vient-elle?

%
% Mettre la réponse ici
%

\item Comparer le comportement de l'algorithme en utilisant les pas (\ref{pfp})\ et (\ref{pas}).

%
% Mettre la réponse ici
%

\item Comparer la methode de plus forte pente et la methode quasi-Newton (qui est déjà implementée -- Série 3).

%
% Mettre la réponse ici
%

\pgfplotstabletypeset[
col sep=comma,
string type,
columns/0/.style={column name=},
columns/1/.style={column name=},
columns/2/.style={column name=},
columns/3/.style={column name=},
columns/4/.style={column name=},
columns/5/.style={column name=},
columns/6/.style={column name=},
columns/7/.style={column name=},
columns/8/.style={column name=},
columns/9/.style={column name=},
every head row/.style={before row={\toprule \multicolumn{2}{c}{$x_0$} &
\multicolumn{2}{c}{$x_{optim,pfp}$} & $f(x_{optim,pfp})$ & $n_{pfp}$ & \multicolumn{2}{c}{$x_{optim,qN}$} & $f(x_{optim,qN})$ & $n_{qN}$ \\
}
},
every last row/.style={after row=\hline},
]{compareSteps.csv}

\end{enumerate}
\end{document}